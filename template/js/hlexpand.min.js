var ConchEx={Browser:{url:document.URL,domain:document.domain,title:document.title,urlpath:document.location.pathname,language:(navigator.browserLanguage||navigator.language).toLowerCase(),canvas:!!document.createElement("canvas").getContext,useragent:function(){var i=navigator.userAgent;return{mobile:!!i.match(/AppleWebKit.*Mobile.*/),ios:!!i.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<i.indexOf("Android")||-1<i.indexOf("Linux"),iPhone:-1<i.indexOf("iPhone")||-1<i.indexOf("Mac"),iPad:-1<i.indexOf("iPad"),trident:-1<i.indexOf("Trident"),presto:-1<i.indexOf("Presto"),webKit:-1<i.indexOf("AppleWebKit"),gecko:-1<i.indexOf("Gecko")&&-1===i.indexOf("KHTML"),weixin:-1<i.indexOf("MicroMessenger")}}()},Cookie:{Set:function(i,t,n){var o;o=n||"",$.cookie(i,t,{expires:o,path:"/"})},Get:function(i){var t=$.cookie(i);return t},Del:function(i){$.cookie(i,null,{expires:-1,path:"/"})}},History:{Limit:12,Days:7,Json:"",Init:function(){var get_history=ConchEx.Cookie.Get("history");if(get_history){var json=eval("("+get_history+")"),list="";for(i=0;i<json.length;i++)list=list+'<li class="vodlist_item"><a href="'+json[i].link+'" title="'+json[i].name+'"><div class="vodlist_thumb" style="background-image:url('+json[i].pic+')"><span class="pic_text text_right">观看至'+json[i].part+'</span></div><div class="vodlist_titbox"><p class="vodlist_title">'+json[i].name+"</p></div></a></li>";$("#conch_history").append(list),$(".conch_history_title").prepend('<a class="clean_history" target="_self" href="javascript:void(0)" onclick="ConchEx.History.Clear();">清空</a>')}else $("#conch_history").append('<li class="conch_history_no"><i class="iconfont"></i>暂无观看记录<p class="user_log_tips"><a class="mac_user" href="javascript:void(0)">登录查看更多</a></p></li>');if($(".history").click(function(){$("html,body").addClass("overhidden"),$(".conch_history_bg").addClass("hfixed"),$("body").append('<div class="mac_pop_bg"></div>'),$("#close_history,.mac_user").click(function(){$(".conch_history_bg").removeClass("hfixed"),$("html,body").removeClass("overhidden"),$(".mac_pop_bg").remove()})}),$(".hl_history").length){var $that=$(".hl_history");ConchEx.History.Set($that.attr("data-name"),$that.attr("data-link"),$that.attr("data-pic"),$that.attr("data-part"))}},Set:function(name,link,pic,part){link||(link=document.URL);var history=ConchEx.Cookie.Get("history"),len=0,canadd=!0;if(history&&(history=eval("("+history+")"),len=history.length,$(history).each(function(){if(name===this.name){canadd=!1;var i="[";return $(history).each(function(t){var n,o,e,s;this.name===name?(n=name,o=pic,e=link,s=part):(n=this.name,o=this.pic,e=this.link,s=this.part),i+='{"name":"'+n+'","pic":"'+o+'","link":"'+e+'","part":"'+s+'"}',t!==len-1&&(i+=",")}),i+="]",ConchEx.Cookie.Set("history",i,this.Days),!1}})),canadd){var json="[",isfirst="]";for(isfirst=len?",":"]",json+='{"name":"'+name+'","pic":"'+pic+'","link":"'+link+'","part":"'+part+'"}'+isfirst,len>this.Limit-1&&(len-=1),i=0;i<len-1;i++)json+='{"name":"'+history[i].name+'","pic":"'+history[i].pic+'","link":"'+history[i].link+'","part":"'+history[i].part+'"},';len>0&&(json+='{"name":"'+history[len-1].name+'","pic":"'+history[len-1].pic+'","link":"'+history[len-1].link+'","part":"'+history[len-1].part+'"}]'),ConchEx.Cookie.Set("history",json,this.Days)}},Clear:function(){ConchEx.Cookie.Del("history"),$("#conch_history").empty(),$(".conch_history_box").html('<div class="conch_history_clear">已清空观看记录</div>')}},Shows:{Text:function(){showdiv=function(i){var t=i.parentNode,n=t.nextSibling;1!==n.nodeType&&(n=n.nextSibling),n.style.display="block",t.style.display="none"},hidediv=function(i){var t=i.parentNode,n=t.previousSibling;1!==n.nodeType&&(n=n.previousSibling),t.style.display="none",n.style.display="block"},$.each($(".context span"),function(i){$(".context span").eq(i).height()>50?$(".context span").eq(i).next().css("display","block"):$(".context span").eq(i).next().css("display","none")})},List:function(){showlist=function(){$(".playlist_notfull,.listshow").css("display","none"),$(".playlist_full").css("display","block")},hidelist=function(){$(".playlist_notfull").css("display","block"),$(".playlist_full").css("display","none")},$.each($("#playlistbox li"),function(){var i=document.getElementById("playlistbox").getElementsByTagName("li").length,t=$(window).width();t>820&&i>24?$(".playlist_full").css("display","none"):($(".playlist_notfull,.listshow").css("display","none"),$(".playlist_full").css("display","block"))})}},Notice:function(){var i=$("#tips_title").val(),t=$("#tips_text").val();null===ConchEx.Cookie.Get("hl_notice")&&($("body").append('<div class="hl_wrap"><div class="hl_content hl_notice"><div class="hl_content_hd"><h4 class="hl_content_title">'+i+'</h4></div><div class="hl_content_bd">'+t+'</div><div class="hl_content_ft"><a class="hl_btn_no" href="javascript:;">我知道了</a><a class="close_box" href="javascript:;">取消</a></div></div></div>'),setTimeout(function(){$(".hl_notice").addClass("hl_show"),$(".hl_wrap").prepend('<div class="mac_pop_bg"></div>'),$(".mac_pop_bg").click(function(){$(".hl_wrap").remove()})},100),$(".hl_btn_no").click(function(){ConchEx.Cookie.Set("hl_notice","ok",1),$(".hl_wrap").remove()}),$(".close_box,.hl_btn_no").click(function(){$(".hl_wrap").remove()}))}};$(function(){ConchEx.History.Init(),ConchEx.Shows.Text(),ConchEx.Shows.List()});