function stars(t){var a=parseInt(t.data.score/2);$("#pa").html(t.data.vod_gold_5+"人"),$("#pb").html(t.data.vod_gold_4+"人"),$("#pc").html(t.data.vod_gold_3+"人"),$("#pd").html(t.data.vod_gold_2+"人"),$("#pe").html(t.data.vod_gold_1+"人");var d=parseInt(t.data.vod_gold_1)+parseInt(t.data.vod_gold_2)+parseInt(t.data.vod_gold_3)+parseInt(t.data.vod_gold_4)+parseInt(t.data.vod_gold_5);d>0&&($("#pam").css("width",parseInt(t.data.vod_gold_5)/d*100+"%"),$("#pbm").css("width",parseInt(t.data.vod_gold_4)/d*100+"%"),$("#pcm").css("width",parseInt(t.data.vod_gold_3)/d*100+"%"),$("#pdm").css("width",parseInt(t.data.vod_gold_2)/d*100+"%"),$("#pem").css("width",parseInt(t.data.vod_gold_1)/d*100+"%")),null!=t.hadpingfen&&null!=t.hadpingfen&&(hadpingfen=1);var i=10*t.data.score;if(i>0?($("#rating-main").show(),$("#rating-kong").hide(),$("#fenshu").animate({width:parseInt(i)+"%"}),$("#total").animate({width:parseInt(i)+"%"}),$("#pingfen").html(t.data.score),$("#pingfen2").html(t.data.score)):($("#rating-main").hide(),$("#rating-kong").show(),$(".loading").addClass("nopingfen").html("暂时没有人评分，赶快从左边打分吧！")),a>0){var n=a-1;$("ul.rating li:lt("+n+")").addClass("current"),$("ul.rating li:eq("+n+")").addClass("current"),$("ul.rating li:gt("+n+")").removeClass("current");var s=new Array("很差","较差","还行","推荐","力荐");$("#ratewords").html(s[n])}}function gold_init(){$("ul.rating li").each(function(t){var a=$(this).attr("title"),d=$("ul.rating li"),i=$(this).index(),n=i+1;$(this).click(function(){hadpingfen>0?($.showfloatdiv({txt:"已经评分,请务重复评分"}),$.hidediv({})):($.showfloatdiv({txt:"数据提交中...",cssname:"loading"}),d.removeClass("active"),$("ul.rating li:lt("+n+")").addClass("active"),$("#ratewords").html(a),$.getJSON(maccms.path+"/index.php/ajax/score?mid="+$("#rating").attr("data-mid")+"&id="+$("#rating").attr("data-id")+"&score="+2*$(this).attr("val"),function(t){1==parseInt(t.code)?(stars(t),$.showfloatdiv({txt:t.msg}),$.hidediv({}),hadpingfen=1):(hadpingfen=1,$.showfloatdiv({txt:t.msg}),$.hidediv({}))}))}).hover(function(){this.myTitle=this.title,this.title="",$(this).nextAll().removeClass("active"),$(this).prevAll().addClass("active"),$(this).addClass("active"),$("#ratewords").html(a)},function(){this.title=this.myTitle,$("ul.rating li:lt("+n+")").removeClass("hover")})}),$(".rating-panle").hover(function(){$(this).find(".rating-show").show()},function(){$(this).find(".rating-show").hide()})}var hadpingfen=0;gold_init();